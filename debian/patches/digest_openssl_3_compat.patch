--- ruby2.7-2.7.6.orig/ext/digest/digest_conf.rb
+++ ruby2.7-2.7.6/ext/digest/digest_conf.rb
@@ -65,13 +65,12 @@ def digest_conf(name, hdr = name, funcs 
 
     dir_config("openssl")
     pkg_config("openssl")
-    require File.expand_path('../../openssl/deprecation', __FILE__)
     if find_openssl_library
       funcs ||= name.upcase
       funcs = Array(funcs)
       types ||= funcs
       hdr = "openssl/#{hdr}.h"
-      if funcs.all? {|func| OpenSSL.check_func("#{func}_Transform", hdr)} &&
+      if funcs.all? {|func| have_func("#{func}_Transform", hdr)} &&
          types.all? {|type| have_type("#{type}_CTX", hdr)}
         $defs << "-D#{name.upcase}_USE_OPENSSL"
         $headers << "#{name}ossl.h"
